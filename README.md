# Redux Toolkit Guide - Complete Understanding

## steps : 

1. `dispatch(reducerMethod(...))`
2. `That method returns: { type: "sliceName/methodName", payload: data }`
3. `dispatch sends this { type, payload } to all reducers in the store`
4. `Only the matching reducer handles it, others ignore it`

## 📚 Overview
We use **2 main libraries**:
- `react-redux` - Connects React components to Redux store
- `@reduxjs/toolkit` - Modern Redux with better developer experience

---

## 🏗️ Core Architecture

### 1. **Slice** (Business Logic)
A slice contains:
- Initial state
- Reducer functions
- Auto-generated action creators

```js
// todoslice.js
import { createSlice, nanoid } from '@reduxjs/toolkit'

const initialState = []

const todoSlice = createSlice({
  name: "mytodos",           // ← This becomes action type prefix
  initialState,
  reducers: {
    addTodo: (state, action) => {
      const { title, completed } = action.payload
      state.push({
        id: nanoid(),
        title,
        completed
      })
      // No need to return state (Immer handles immutability)
    },
    removeTodo: (state, action) => {
      return state.filter(todo => todo.id !== action.payload.id)
    }
  }
})

// Export action creators (auto-generated)
export const { addTodo, removeTodo } = todoSlice.actions

// Export reducer function
export default todoSlice.reducer
```

### 2. **Store** (Central State Container)
Combines all reducers into one store:

```js
// store.js
import { configureStore } from '@reduxjs/toolkit'
import todoReducer from '../slices/todoslice'

const store = configureStore({
  reducer: {
    todos: todoReducer,    // ← Key becomes state property name
    // users: userReducer, // ← You can add more slices
  }
})

export default store
```

---

## 🔗 Connecting React to Redux

### 3. **Reading State** - `useSelector`
Gets data FROM the store:

```js
import { useSelector } from 'react-redux'

function TodoList() {
  const todos = useSelector((state) => {
    console.log("Complete State:", state)
    // state = { todos: [...], users: [...] }
    
    return state.todos  // ← Returns only todos array
  })

  return (
    <div>
      {todos.map(todo => (
        <div key={todo.id}>{todo.title}</div>
      ))}
    </div>
  )
}
```

**State Structure Visualization:**
```js
state = {
  todos: [
    { id: "1", title: "Learn Redux", completed: false },
    { id: "2", title: "Build App", completed: true }
  ]
  // Other slices would appear here too
}
```

### 4. **Updating State** - `useDispatch`
Sends data TO the store:

```js
import { useDispatch } from 'react-redux'
import { addTodo, removeTodo } from '../slices/todoslice'

function AddTodo() {
  const dispatch = useDispatch()

  const handleAddTodo = () => {
    // Dispatch action with payload
    dispatch(addTodo({
      title: "New Todo",
      completed: false
    }))
  }

  const handleRemoveTodo = (todoId) => {
    dispatch(removeTodo({ id: todoId }))
  }

  return (
    <div>
      <button onClick={handleAddTodo}>Add Todo</button>
    </div>
  )
}
```

---

## ⚙️ How It Works Under The Hood

### Data Flow:
1. **Component** calls `dispatch(addTodo(payload))`
2. **Action Creator** creates action object:
   ```js
   {
     type: "mytodos/addTodo",
     payload: { title: "New Todo", completed: false }
   }
   ```
3. **Store** sends action to reducer
4. **Reducer** updates state immutably
5. **Component** re-renders with new state (via useSelector)

### Auto-Generated Action Creators:
When you export `{ addTodo }`, you're getting:
```js
function addTodo(payload) {
  return {
    type: "mytodos/addTodo",  // slice.name + "/" + reducer.name
    payload: payload
  }
}
```

### The Complete Reducer Function:
Redux Toolkit creates this for you:
```js
function todoReducer(state = initialState, action) {
  switch(action.type) {
    case "mytodos/addTodo":
      // Runs your addTodo logic
      return newState
    
    case "mytodos/removeTodo":
      // Runs your removeTodo logic
      return newState
    
    default:
      return state
  }
}
```

---

## 🎯 Key Concepts Summary

| Concept | Purpose | Usage |
|---------|---------|-------|
| **Slice** | Define state + logic for one feature | `createSlice()` |
| **Store** | Central state container | `configureStore()` |
| **useSelector** | Read state in components | `useSelector(state => state.todos)` |
| **useDispatch** | Update state from components | `dispatch(addTodo(data))` |
| **Action** | Description of what happened | Auto-generated by slice |
| **Reducer** | How to update state | Functions inside slice.reducers |

---

## 🔧 Important Notes

- **Immer Integration**: You can directly mutate state in reducers (Redux Toolkit handles immutability)
- **DevTools**: Automatic integration with Redux DevTools for debugging
- **Action Types**: Auto-generated as `"sliceName/reducerName"`
- **State Shape**: Determined by your `configureStore({ reducer: {...} })` object keys

---

## 📝 Complete Example Structure

```
src/
├── store/
│   └── store.js          # Configure store
├── slices/
│   ├── todoslice.js      # Todo logic
│   └── userslice.js      # User logic  
└── components/
    ├── TodoList.js       # useSelector
    └── AddTodo.js        # useDispatch
```